<Page x:Class="DataReceiver.Views.Communication.CommunicationView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:DataReceiver.Views.Communication"
      mc:Ignorable="d" 
      xmlns:vm="clr-namespace:DataReceiver.ViewModels.Communication"
      d:DataContext="{d:DesignInstance Type=vm:CommunicationViewModel}"
      xmlns:hc="https://handyorg.github.io/handycontrol"
      d:DesignHeight="450" d:DesignWidth="800"
      FontFamily="Arial"
      xmlns:wd="https://github.com/WPFDevelopersOrg/WPFDevelopers"
      Title="SocketView">


    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition MaxWidth="130"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!--sider bar-->
        <Grid Grid.Column="0" HorizontalAlignment="Left">

            <Grid.RowDefinitions>
                <RowDefinition Height="8*"/>
                <RowDefinition Height="*" MaxHeight="50"/>
            </Grid.RowDefinitions>

            <!--添加按钮-->
            <Grid Grid.Row="1">
                <Button Margin="0,5,0,5" 
                        Width="110" 
                        Height="30" 
                        Content="Add" 
                        Command="{Binding AddSubPageCommand}"
                        Style="{StaticResource ButtonPrimary}"/>
            </Grid>

            <!--侧边栏-->
            <hc:TransitioningContentControl Grid.Row="0">
                <hc:SideMenu Width="130"
                             ExpandMode="ShowAll" AutoSelect="True">
                    <hc:Interaction.Triggers>
                        <hc:EventTrigger EventName="SelectionChanged">
                            <hc:EventToCommand Command="{Binding GetCurrentItemCommand}"
                                               PassEventArgsToCommand="True" />
                        </hc:EventTrigger>
                    </hc:Interaction.Triggers>

                    <hc:SideMenuItem Header="常用协议" FontSize="16" FontWeight="Bold" >
                        <hc:SideMenuItem.Icon>
                            <Path Data="{StaticResource menu_geom}" 
                                  Stroke="{DynamicResource menu_background}" 
                                  Stretch="Uniform" Fill="{DynamicResource menu_background}" 
                                  Width="25" 
                                  Height="25"/>
                        </hc:SideMenuItem.Icon>

                        <hc:SideMenuItem Header="TCP Client" x:Name="TCP">
                            <hc:SideMenuItem.Icon>
                                <Path Data="{StaticResource tcp_geom}" 
                                      Stroke="{DynamicResource icon_foreground}" 
                                      Stretch="Uniform" Fill="{DynamicResource icon_foreground}" 
                                      Width="20" 
                                      Height="20"/>
                            </hc:SideMenuItem.Icon>
                        </hc:SideMenuItem>

                        <hc:SideMenuItem Header="FTP Server" x:Name="FTP">
                            <hc:SideMenuItem.Icon>
                                <Path Data="{StaticResource ftp_geom}" 
                                  Stroke="{DynamicResource icon_foreground}" 
                                  Stretch="Uniform" Fill="{DynamicResource icon_foreground}" 
                                  Width="20" 
                                  Height="20"/>
                            </hc:SideMenuItem.Icon>
                        </hc:SideMenuItem>

                        <hc:SideMenuItem Header="UDP" x:Name="UDP">
                            <hc:SideMenuItem.Icon>
                                <Path Data="{StaticResource udp_geom}" 
                                  Stroke="{DynamicResource icon_foreground}" 
                                  Stretch="Uniform" Fill="{DynamicResource icon_foreground}" 
                                  Width="20" 
                                  Height="20"/>
                            </hc:SideMenuItem.Icon>
                        </hc:SideMenuItem>

                    </hc:SideMenuItem>
                </hc:SideMenu>
            </hc:TransitioningContentControl>
        </Grid>


        <Grid Grid.Column="1" >
            <hc:TransitioningContentControl>
                <Border BorderThickness="1" BorderBrush="{DynamicResource border_brush}">
                    <hc:TabControl ItemsSource="{Binding VMList}"  TabItemWidth="180"
                                    IsAnimationEnabled="True"
                                   ShowCloseButton="True" 
                                   
                                   IsDraggable="True" >
                        <hc:TabControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Title}"/>
                            </DataTemplate>
                        </hc:TabControl.ItemTemplate>

                        <hc:Interaction.Triggers>
                            <hc:RoutedEventTrigger RoutedEvent="hc:TabItem.Closing">
                                <hc:EventToCommand Command="{Binding ClosingCommand}" PassEventArgsToCommand="True" />
                            </hc:RoutedEventTrigger>
                            <!--<hc:RoutedEventTrigger RoutedEvent="hc:TabItem.Closed">
                                <hc:EventToCommand Command="{Binding ClosedCommand}" PassEventArgsToCommand="True" />
                            </hc:RoutedEventTrigger>-->
                        </hc:Interaction.Triggers>

                        <!--映射页面-->
                        <hc:TabControl.Resources>
                            <DataTemplate DataType="{x:Type vm:TcpClientViewModel}">
                                <local:TcpView/>
                            </DataTemplate>
                            <DataTemplate DataType="{x:Type vm:FtpServerViewModel}">
                                <local:FtpView/>
                            </DataTemplate>
                        </hc:TabControl.Resources>
                    </hc:TabControl>
                </Border>
            </hc:TransitioningContentControl>
        </Grid>
    </Grid>
</Page>
